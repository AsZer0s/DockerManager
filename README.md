# Docker Manager - å®¹å™¨ç®¡ç†ç³»ç»Ÿ

ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ Docker å®¹å™¨ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒå¤šæœåŠ¡å™¨ç®¡ç†ã€å®æ—¶ç›‘æ§ã€Web SSH æ§åˆ¶å°å’Œ Telegram æœºå™¨äººã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- **å¤šæœåŠ¡å™¨ç®¡ç†**: è½»æ¾æ·»åŠ ã€åˆ é™¤å’Œç®¡ç†å¤šä¸ªæœåŠ¡å™¨
- **Docker å®¹å™¨æ“ä½œ**: æŸ¥çœ‹å®¹å™¨åˆ—è¡¨ã€è¯¦ç»†ä¿¡æ¯ã€æ—¥å¿—ï¼Œå¹¶æ‰§è¡Œå¯åŠ¨ã€åœæ­¢ã€é‡å¯ç­‰æ“ä½œ
- **ç”¨æˆ·æƒé™æ§åˆ¶**: ç®¡ç†å‘˜å¯ä»¥æˆæƒç‰¹å®šç”¨æˆ·è®¿é—®æŒ‡å®šçš„æœåŠ¡å™¨
- **ä¿¡æ¯éšè—**: ç®¡ç†å‘˜å¯ä»¥ä¸ºæ™®é€šç”¨æˆ·éšè—æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚æœåŠ¡å™¨åœ°å€ã€ç«¯å£ã€å®¹å™¨IDç­‰
- **ç½‘é¡µç‰ˆ SSH æ§åˆ¶å°**: æä¾›ä¸€ä¸ªåŸºäº Web çš„å®æ—¶ SSH ç»ˆç«¯ï¼Œæ–¹ä¾¿ç›´æ¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œå‘½ä»¤
- **å®æ—¶ç›‘æ§**: ç›‘æ§æœåŠ¡å™¨çŠ¶æ€ä¿¡æ¯ï¼ˆCPUã€RAMã€ç£ç›˜ã€ç½‘ç»œç­‰ï¼‰å’Œå®¹å™¨èµ„æºä½¿ç”¨æƒ…å†µ
- **Telegram æœºå™¨äºº**: é€šè¿‡ Telegram æŸ¥è¯¢å®¹å™¨çŠ¶æ€ã€æ‰§è¡ŒåŸºæœ¬æ“ä½œ
- **Telegram Web App**: åœ¨ Telegram å†…ç›´æ¥ä½¿ç”¨ Web ç•Œé¢
- **çµæ´»éƒ¨ç½²**: æ”¯æŒä½¿ç”¨ Docker Compose åœ¨æ‚¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šéƒ¨ç½²

## ğŸ—ï¸ æŠ€æœ¯æ ˆ

### åç«¯
- **Node.js 22** + **Express** - Web æ¡†æ¶
- **SQLite** - è½»é‡çº§æ•°æ®åº“
- **Dockerode** - Docker API å®¢æˆ·ç«¯
- **Socket.IO** - WebSocket å®æ—¶é€šä¿¡
- **JWT** - èº«ä»½è®¤è¯
- **bcryptjs** - å¯†ç åŠ å¯†
- **Telegraf** - Telegram æœºå™¨äººæ¡†æ¶
- **SSH2** - SSH è¿æ¥åº“
- **SystemInformation** - ç³»ç»Ÿç›‘æ§

### å‰ç«¯
- **React 18** + **TypeScript** - ç”¨æˆ·ç•Œé¢
- **Ant Design** - UI ç»„ä»¶åº“
- **React Query** - æ•°æ®è·å–å’Œç¼“å­˜
- **Zustand** - çŠ¶æ€ç®¡ç†
- **Socket.IO Client** - WebSocket å®¢æˆ·ç«¯
- **ECharts** - æ•°æ®å¯è§†åŒ–
- **XTerm.js** - ç»ˆç«¯æ¨¡æ‹Ÿå™¨
- **Vite** - æ„å»ºå·¥å…·

### éƒ¨ç½²
- **Docker** + **Docker Compose** - å®¹å™¨åŒ–éƒ¨ç½²
- **å¤šé˜¶æ®µæ„å»º** - ä¼˜åŒ–é•œåƒå¤§å°

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Docker å’Œ Docker Compose
- Node.js 22+ (ç”¨äºå¼€å‘)

### ä¸€é”®éƒ¨ç½²

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <repository-url>
cd docker-manager
```

2. **é…ç½®ç¯å¢ƒå˜é‡**
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp server/env.example .env

# ç¼–è¾‘ç¯å¢ƒå˜é‡
nano .env
```

3. **å¯åŠ¨æœåŠ¡**
```bash
docker-compose up -d
```

4. **è®¿é—®åº”ç”¨**
- Web ç•Œé¢: http://localhost:3000
- é»˜è®¤ç®¡ç†å‘˜è´¦æˆ·: admin / admin@ztms.top

### ç¯å¢ƒå˜é‡é…ç½®

åœ¨ `.env` æ–‡ä»¶ä¸­é…ç½®ä»¥ä¸‹å˜é‡ï¼š

```bash
# Telegram æœºå™¨äººé…ç½®
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here
TELEGRAM_WEBAPP_URL=https://yourdomain.com/telegram-webapp

# JWT é…ç½®
JWT_SECRET=your_jwt_secret_key_here

# åŠ å¯†é…ç½®
ENCRYPTION_KEY=your_32_character_encryption_key_here

# Telegram ä»£ç†é…ç½®ï¼ˆå¯é€‰ï¼‰
TGBOT_PROXY=http://127.0.0.1:10808
```

## ğŸ“– ä½¿ç”¨æŒ‡å—

### ç®¡ç†å‘˜è´¦æˆ·

ç³»ç»Ÿä¼šåœ¨é¦–æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·ï¼š
- **ç”¨æˆ·å**: admin
- **é‚®ç®±**: admin@ztms.top
- **å¯†ç **: è¯·æŸ¥çœ‹å¯åŠ¨æ—¥å¿—æˆ–ä½¿ç”¨åˆå§‹åŒ–è„šæœ¬

### æ·»åŠ æœåŠ¡å™¨

1. ç™»å½•ç®¡ç†ç•Œé¢
2. è¿›å…¥"æœåŠ¡å™¨ç®¡ç†"é¡µé¢
3. ç‚¹å‡»"æ·»åŠ æœåŠ¡å™¨"
4. å¡«å†™æœåŠ¡å™¨ä¿¡æ¯ï¼ˆä¸»æœºåœ°å€ã€ç«¯å£ã€è®¤è¯ä¿¡æ¯ï¼‰
5. æµ‹è¯•è¿æ¥ç¡®ä¿é…ç½®æ­£ç¡®

æ”¯æŒä¸¤ç§è¿æ¥æ–¹å¼ï¼š
- **å¯†ç è®¤è¯**: ä¸»æœºåœ°å€ã€SSHç«¯å£ã€ç”¨æˆ·åå’Œå¯†ç 
- **å¯†é’¥è®¤è¯**: ä¸»æœºåœ°å€ã€SSHç«¯å£ã€ç”¨æˆ·åå’Œç§é’¥å†…å®¹

### ç®¡ç†å®¹å™¨

1. åœ¨"å®¹å™¨ç®¡ç†"é¡µé¢é€‰æ‹©æœåŠ¡å™¨
2. æŸ¥çœ‹å®¹å™¨åˆ—è¡¨å’ŒçŠ¶æ€
3. æ‰§è¡Œå®¹å™¨æ“ä½œï¼ˆå¯åŠ¨ã€åœæ­¢ã€é‡å¯ã€åˆ é™¤ï¼‰
4. æŸ¥çœ‹å®¹å™¨æ—¥å¿—å’Œè¯¦ç»†ä¿¡æ¯

### ç›‘æ§ç³»ç»Ÿ

1. è¿›å…¥"ç›‘æ§ä¸­å¿ƒ"
2. é€‰æ‹©è¦ç›‘æ§çš„æœåŠ¡å™¨
3. æŸ¥çœ‹å®æ—¶ CPUã€å†…å­˜ã€ç£ç›˜ä½¿ç”¨æƒ…å†µ
4. ç›‘æ§å®¹å™¨èµ„æºä½¿ç”¨æƒ…å†µ

### SSH æ§åˆ¶å°

1. è¿›å…¥"SSH æ§åˆ¶å°"é¡µé¢
2. é€‰æ‹©æœåŠ¡å™¨å¹¶å»ºç«‹è¿æ¥
3. åœ¨ Web ç»ˆç«¯ä¸­æ‰§è¡Œå‘½ä»¤
4. æ”¯æŒå¤šè¡Œå‘½ä»¤å’Œå‘½ä»¤å†å²

### ç”¨æˆ·æƒé™ç®¡ç†

1. ç®¡ç†å‘˜å¯ä»¥åˆ›å»ºç”¨æˆ·è´¦æˆ·
2. ä¸ºæ¯ä¸ªç”¨æˆ·åˆ†é…æœåŠ¡å™¨è®¿é—®æƒé™
3. è®¾ç½®æŸ¥çœ‹ã€æ§åˆ¶ã€SSH ç­‰æƒé™
4. å¯é€‰æ‹©éšè—æ•æ„Ÿä¿¡æ¯

### Telegram æœºå™¨äºº

1. åœ¨ Telegram ä¸­æ‰¾åˆ° [@BotFather](https://t.me/botfather)
2. åˆ›å»ºæ–°æœºå™¨äººå¹¶è·å– Token
3. å°† Token è®¾ç½®åˆ° `TELEGRAM_BOT_TOKEN` ç¯å¢ƒå˜é‡
4. ç”¨æˆ·å¯ä»¥åœ¨ Web ç•Œé¢ç»‘å®š Telegram ID
5. é€šè¿‡æœºå™¨äººæŸ¥è¯¢æœåŠ¡å™¨å’Œå®¹å™¨çŠ¶æ€

## ğŸ”§ å¼€å‘æŒ‡å—

### æœ¬åœ°å¼€å‘

1. **å®‰è£…ä¾èµ–**
```bash
npm install
cd server && npm install
cd ../client && npm install
```

2. **å¯åŠ¨å¼€å‘æœåŠ¡**
```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
npm run dev

# æˆ–åˆ†åˆ«å¯åŠ¨
npm run server:dev  # åç«¯æœåŠ¡
npm run client:dev  # å‰ç«¯æœåŠ¡
```

3. **åˆå§‹åŒ–æ•°æ®åº“**
```bash
npm run init
```

### é¡¹ç›®ç»“æ„

```
docker-manager/
â”œâ”€â”€ client/                 # å‰ç«¯ React åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/     # å¯å¤ç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ pages/         # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ services/      # API æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ stores/        # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â””â”€â”€ hooks/         # è‡ªå®šä¹‰ Hooks
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ server/                 # åç«¯ Node.js åº”ç”¨
â”‚   â”œâ”€â”€ routes/            # API è·¯ç”±
â”‚   â”œâ”€â”€ services/          # ä¸šåŠ¡é€»è¾‘æœåŠ¡
â”‚   â”œâ”€â”€ config/            # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ data/              # æ•°æ®åº“æ–‡ä»¶
â”œâ”€â”€ docker-compose.yml     # Docker ç¼–æ’æ–‡ä»¶
â”œâ”€â”€ Dockerfile            # Docker é•œåƒæ„å»ºæ–‡ä»¶
â””â”€â”€ .dockerignore         # Docker å¿½ç•¥æ–‡ä»¶
```

### API æ–‡æ¡£

ä¸»è¦ API ç«¯ç‚¹ï¼š

- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•
- `GET /api/servers` - è·å–æœåŠ¡å™¨åˆ—è¡¨
- `GET /api/containers/:serverId` - è·å–å®¹å™¨åˆ—è¡¨
- `POST /api/containers/:serverId/:containerId/start` - å¯åŠ¨å®¹å™¨
- `GET /api/monitoring/current/:serverId` - è·å–ç›‘æ§æ•°æ®
- `POST /api/ssh/:serverId/execute` - æ‰§è¡Œ SSH å‘½ä»¤
- `POST /api/telegram-verification/send-code` - å‘é€ Telegram éªŒè¯ç 

## ğŸ›¡ï¸ å®‰å…¨è€ƒè™‘

- æ‰€æœ‰å¯†ç å’Œæ•æ„Ÿä¿¡æ¯éƒ½ç»è¿‡åŠ å¯†å­˜å‚¨
- æ”¯æŒ JWT ä»¤ç‰Œè®¤è¯
- å®ç°äº†ç”¨æˆ·æƒé™æ§åˆ¶
- æ”¯æŒéšè—æ•æ„Ÿä¿¡æ¯
- SSH è¿æ¥æ”¯æŒå¯†é’¥è®¤è¯
- åŒ…å«è¯·æ±‚é¢‘ç‡é™åˆ¶
- Telegram ç»‘å®šéœ€è¦éªŒè¯ç ç¡®è®¤

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

- å®æ—¶ç³»ç»Ÿç›‘æ§ï¼ˆCPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œï¼‰
- å®¹å™¨èµ„æºä½¿ç”¨ç›‘æ§
- æ“ä½œæ—¥å¿—è®°å½•
- é”™è¯¯æ—¥å¿—å’Œå‘Šè­¦
- WebSocket å®æ—¶æ•°æ®æ¨é€
- æ”¯æŒæ·±è‰²æ¨¡å¼

## ğŸ”„ å¤‡ä»½å’Œæ¢å¤

### æ•°æ®åº“å¤‡ä»½
```bash
# å¤åˆ¶æ•°æ®åº“æ–‡ä»¶
cp server/data/database.sqlite backup/database-$(date +%Y%m%d).sqlite
```

### æ•°æ®æ¢å¤
```bash
# æ¢å¤æ•°æ®åº“æ–‡ä»¶
cp backup/database-20240101.sqlite server/data/database.sqlite
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **Docker è¿æ¥å¤±è´¥**
   - æ£€æŸ¥ Docker æœåŠ¡æ˜¯å¦è¿è¡Œ
   - ç¡®è®¤ Docker socket æƒé™
   - éªŒè¯æœåŠ¡å™¨ç½‘ç»œè¿æ¥

2. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   - æ£€æŸ¥ SQLite æ•°æ®åº“æ–‡ä»¶æƒé™
   - ç¡®è®¤æ•°æ®ç›®å½•å­˜åœ¨
   - æŸ¥çœ‹åº”ç”¨æ—¥å¿—

3. **Telegram æœºå™¨äººæ— å“åº”**
   - æ£€æŸ¥ Bot Token æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤ç½‘ç»œè¿æ¥å’Œä»£ç†è®¾ç½®
   - æŸ¥çœ‹æœºå™¨äººæ—¥å¿—

4. **SSH è¿æ¥è¶…æ—¶**
   - æ£€æŸ¥æœåŠ¡å™¨ç½‘ç»œè¿æ¥
   - ç¡®è®¤ SSH æœåŠ¡è¿è¡ŒçŠ¶æ€
   - éªŒè¯è®¤è¯ä¿¡æ¯

### æŸ¥çœ‹æ—¥å¿—

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose logs -f app

# æŸ¥çœ‹åº”ç”¨å†…éƒ¨æ—¥å¿—
docker exec docker-manager-app cat /app/logs/combined.log
```

## ğŸš€ éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

### ä½¿ç”¨ Docker Compose

1. **é…ç½®ç¯å¢ƒå˜é‡**
```bash
cp server/env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œè®¾ç½®ç”Ÿäº§ç¯å¢ƒå˜é‡
```

2. **å¯åŠ¨æœåŠ¡**
```bash
docker-compose up -d
```

3. **é…ç½®åå‘ä»£ç†**ï¼ˆå¯é€‰ï¼‰
```nginx
server {
    listen 80;
    server_name yourdomain.com;
    
    location / {
        proxy_pass http://localhost:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

### ç¯å¢ƒå˜é‡è¯´æ˜

| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|--------|
| `NODE_ENV` | è¿è¡Œç¯å¢ƒ | production |
| `TELEGRAM_BOT_TOKEN` | Telegram æœºå™¨äºº Token | å¿…å¡« |
| `TELEGRAM_WEBAPP_URL` | Telegram Web App URL | å¿…å¡« |
| `JWT_SECRET` | JWT å¯†é’¥ | å¿…å¡« |
| `ENCRYPTION_KEY` | åŠ å¯†å¯†é’¥ | å¿…å¡« |
| `TGBOT_PROXY` | Telegram ä»£ç† | å¯é€‰ |

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®çš„æ”¯æŒï¼š
- [Docker](https://www.docker.com/)
- [React](https://reactjs.org/)
- [Ant Design](https://ant.design/)
- [Express.js](https://expressjs.com/)
- [SQLite](https://www.sqlite.org/)
- [Telegraf](https://telegraf.js.org/)

## ğŸ“ æ”¯æŒ

å¦‚æœæ‚¨é‡åˆ°é—®é¢˜æˆ–æœ‰å»ºè®®ï¼Œè¯·ï¼š
- æäº¤ [Issue](https://github.com/your-repo/issues)
- æŸ¥çœ‹ [Wiki](https://github.com/your-repo/wiki) è·å–æ›´å¤šæ–‡æ¡£

---

**Docker Manager** - è®©å®¹å™¨ç®¡ç†å˜å¾—ç®€å•é«˜æ•ˆï¼ ğŸ³